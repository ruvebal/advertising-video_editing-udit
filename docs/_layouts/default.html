<!doctype html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}" id="html-root">
	<head>
		<script>
			// Apply theme immediately to prevent flash (default to dark)
			(function () {
				try {
					const storedTheme = localStorage.getItem('theme');
					const theme = storedTheme || 'dark';
					if (theme === 'dark') {
						document.documentElement.classList.add('dark');
					} else {
						document.documentElement.classList.remove('dark');
					}
				} catch (e) {
					document.documentElement.classList.add('dark');
				}
			})();
		</script>
		{% include head.html %}
	</head>
	<body
		class="bg-white dark:bg-neutral-950 text-slate-900 dark:text-neutral-100 antialiased transition-colors duration-200">
		<a href="#main" class="skip-link">Skip to main content</a>
		{% include header.html %}
		<main id="main" class="min-h-screen prose-slate dark:prose-invert w-full max-w-none">{{ content }}</main>
		{% include footer.html %} {% include back-to-top.html %}
		<script>
			// Theme toggle functionality
			(function () {
				function initThemeToggle() {
					const themeToggle = document.getElementById('theme-toggle');
					const htmlRoot = document.documentElement;

					if (!themeToggle) return;

					themeToggle.addEventListener('click', function (e) {
						e.preventDefault();
						const isDark = htmlRoot.classList.toggle('dark');
						try {
							localStorage.setItem('theme', isDark ? 'dark' : 'light');
						} catch (err) {
							console.warn('Could not save theme preference:', err);
						}
					});
				}

				if (document.readyState === 'loading') {
					document.addEventListener('DOMContentLoaded', initThemeToggle);
				} else {
					initThemeToggle();
				}
			})();
		</script>
		<script src="{{ site.baseurl }}/assets/js/video-timestamps.js" defer></script>
		<script src="{{ site.baseurl }}/assets/js/back-to-top.js" defer></script>
	</body>
</html>
